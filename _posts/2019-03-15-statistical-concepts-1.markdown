---
layout: post
title:  "一些统计基本概念（先验概率，后验概率，似然函数，共轭先验）"
date:   2019-03-15 20:00:00 +0800
categories: statistical-concepts
---
## 一些统计基本概念（先验概率，后验概率，似然函数，共轭先验）

### 贝叶斯学派和频率学派的区别
这两者在于看待随机性的角度不一样。频率学派认为数据是从一个固定的假设来的，而这个假设是未知的。有人说：“世界是确定的某种形式，但我不知道它是怎样的。因为数据总是有限且有噪声，所以我无法通过收集数据来说明世界是如何的。因此，我将使用统计数据来排列可能性，并或多或少进行排除。”放到样本的角度上看，我们可以看出频率学派的角度是，这些样本是从固定的参数产生出来的，我们可以通过统计这些样本去感知参数的一些可能性。  
贝叶斯派认为数据是从一个随机的假设来的。贝叶斯学派会说：“我不知道世界是什么样子，我能做的就是用有限数据，因此我会用统计从已有的数据去推断这个世界可能的样子。”所以概率在贝叶斯学派的角度，是和假设的随机性有关，而这个随机性往往与我们对事件的了解情况有关（比如我们对事件的了解，给参数一个可能的分布）。放在样本的角度上看，我们可以看到，贝叶斯学派认为产生样本的方式是不确定的，而这不确定性和某些先验信息是有关的，也就是产生样本的参数就是随机的，我们可以从已有数据和我们自己对事件的了解程度去反推事件可能的样子。  
因此，这两者的有些统计概念是独有的。

### 似然函数，极大似然估计（频率派）
似然函数是一个关于给定数据下统计模型参数的函数。所谓似然就是可能性，似然函数往往在频率派中表示在某一个给定的参数下观测数据发生的可能性，而关于这个参数的函数就是似然函数。我们这么表示它: 对于离散情况：$L(\theta)=P(X|\theta)$；对于连续情况：$L(\theta)=f(X|\theta)$。  
极大似然估计，也就是在我们希望能在某个特殊的参数下，观测的数据是以最大的概率出现的。通过极大似然函数，我们就可以解得那个特殊的参数。

### 先验概率（贝叶斯派）
关于随机变量$X$的先验概率往往是关于某个变量$X$的概率分布，是在知道其他除$X$外的信息之前$X$的可能情况，对$ X $可能的猜测，这种猜测可以是主观的，也可以是根据$X$的一些信息推断出来的。$X$可以是参数，也可以是一个潜在变量。  
例子：抛硬币，我可以根据以前的历史记录，直接给$X$（出现正面的概率p）定为0.5，或者是一个服从$ U(0.4,0.5) $的一个分布，即使这个硬币不均匀。我也可以不根据任何信息，取先验概率为0.1(也就是$P(p=0.1)=1$).

### 后验概率（贝叶斯派）
和先验概率相比，关于随机变量$Z$的所谓的后验概率就是在给定关于$Z$的相关信息或者相关知识下，对$Z$可能的猜测，是一个条件概率。后验是指考虑了与变量相关的证据。比如挖宝藏，如果在金属探测点上进行挖掘的是后验概率。  
通常给定证据$X$下，一个参数的后验概率表示是$P(\theta|X)$，这和似然函数是相反的，似然函数指是给定参数下证据的概率。可见，贝叶斯派和频率派在推断上是明显不一样的，贝叶斯派是用有限的数据和先验知识去推断背后规则的可能性，频率派是在某个给定的规则下，对数据的猜测。
通常后验概率是以先验概率和似然来计算的：
$P(\theta|X)=\frac{P(X|\theta)P(\theta)}{P(X)}$

### 共轭先验（贝叶斯派）
在贝叶斯概率理论中，如果先验分布$P(\theta)$和后验分布$P(\theta|X)$是在同一个概率分布族的话，则这个先验分布和后验分布就是共轭分布，其中，先验分布被称为共轭先验。后验分布：
$$p(\theta|x) = \frac{p(x|\theta)p(\theta)}{\int p(x|\theta')p(\theta')d\theta'}$$
往往似然函数是根据数据生成过程来确定的，可视为固定的。从式子可看出，在确定似然下，先验分布的选择会决定后验分布计算的难易。  
共轭先验的作用：使得计算方便。使得贝叶斯推断的计算容易些。先验和后验形成闭环，在大多数情况下，后验预测会有良好形式。  
共轭先验的存在：并不总是存在的，只在指数族似然下存在。而且如果先验不是指数族的话，贝叶斯推断会很困难。



