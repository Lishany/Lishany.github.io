---
layout: post
title:  "Simpson's Paradox"
date:   2019-06-26 15:21:00 -0600
categories: Statistics
---
## Simpson悖论
最近忙死了。。。 感觉每次理顺完这个悖论，很快就忘记了。。。然后再重新理顺。。所以还是写下来吧..\\
举一个简单的例子，比如有两个人A和B是下围棋的，有两种难度的赛场：甲赛场很难，乙赛场一般。他们每下一次围棋的结果只有赢和输。A一直喜欢挑战高难度，所以几乎去甲赛场，B比较多去乙赛场。他们都比了100次比赛。其中，A在甲赛场比了80次，赢40场输40场，在乙赛场比了20次，赢18场输2场，而B在甲赛场比了20次，赢2场输18场，在乙赛场比了80次，赢60场输20场。然后我们分别在甲乙赛场算他们的胜率，A在甲赛场的胜率是50%，在乙赛场的胜率是90%。B在甲赛场的胜率是10%，在乙赛场的胜率是75%。可见，A在分别两个赛场的胜率都比B高不少，A的围棋水平是比B高不少的。然后咱们算他们的总胜率，A在所有比赛中的胜率是58%，B在所有比赛中的胜率是62%，结果A的胜率反而比B低了，如果只看所有比赛的平均胜率，那么就得出B的围棋水平比A厉害。这种现象很奇怪，这也就是所谓的simpson悖论。\\
该如何去解释这种现象呢？？我们换种角度去思考，这种现象的产生其实无非是A喜欢去甲赛场，如果A不要老去甲赛场，多去乙赛场，可能就轮不到B得瑟了。我们有这么一套逻辑去区分A和B的实力，无非就是基于一个假想，我们假想A也像B这么去这些赛场的话，肯定都比B胜率高不少。而这样的假想恰恰是把A和他爱去甲赛场这一事实给独立了，事实上，A的围棋实力确实也与赛场无关，所以我们乐意看的是这种“客观”的表示。\\
我们把这个问题给统计化，A和B是变量“人”，甲、乙赛场是变量“赛场”，输赢是变量“输赢”。‘人’和‘赛场’都会对‘输赢’有影响，是单向的。\\
回到原题，为什么会出现simpson悖论呢？其实很简单，这种现象出现的原因是直接根据观测数据得到的，而观测数据中A和B去的赛场不均匀，所以体现出了‘人’和‘赛场’是不独立的，也就是所谓的图结构，除了‘人’和‘赛场’都会对‘输赢’有影响，还有‘人’对‘赛场’也有影响，那么计算P(‘输赢’|‘人’)，是要考虑'赛场'的。$P(赢|A) = P(赢,甲|A) + P(赢,乙|A) = (P(赢,甲,A)+P(赢,乙,A))/P(A) = (\frac{40}{200}+\frac{18}{200})/\frac{100}{200} = 50%$，其实在计算P(赢,甲,A)时就会去包含‘赛场’对‘人’的影响，$P(赢,甲,A) = P(赢|A,甲)P(甲|A)P(A)$，所以$P(赢|A) = P(赢,甲|A) + P(赢,乙|A) = P(赢|A,甲)P(甲|A) + P(赢|A,乙)P(乙|A)$，可见，融入了A对赛场选择不均匀这一信息，‘人’和赛场是不独立的，所以才会得到simpson悖论。\\
那么如何去解决这个悖论了，很简单，就是把我们上述说的例子中的假想成真就行，也就是客观去看待‘人’和‘赛场’，也就是不去根据观测数据去赋予它们不独立，而是根据客观事实等，强行让它们独立，边际独立。这样P(人,赛场)= P(人)P(赛场)。所以我们在计算$P(输赢,赛场,人)$时，是按$P(输赢,赛场,人) = P(输赢|赛场，人)P(赛场)P(人)$这样计算的，此时，我们获得$P(赢|A) = P(赢,甲|A) + P(赢,乙|A) = P(赢|甲,A)P(甲) + P(赢|乙,A)P(乙) = \frac{40}{80}\frac{100}{200}+\frac{18}{20}\frac{100}{200} = 70%$，在这种假设下，$P(赢|B) = 42.5%$。这也就是我们所谓的客观围棋水平了。\\
Remark,这是一个非典型的边际独立的例子。因为数据其实是显示是不独立的，但我们是假设独立性了。
一般的边际独立，如：抛两枚硬币，两面相同才算赢，直接算概率，完全满足边际独立，数据本身就显示独立性。\\

Deep thinking: 其实实际中，simpson悖论应该不少，因为人总是有偏向性的（带有主观，使得数据分布就不均匀），也就是会产生这么不少非典型的边际独立或者条件独立的例子，这样产生了数据是带有不独立性的，但客观的事实又是独立的（类似咱们围棋的例子），如果我们只从数据给的因果关系去进行一些数值的推断，比如围棋水平的推断，可能会得到一些错误的结果就像围棋例子，只从数据去推断出来的关系是赛场和人有关系的，如果我们用上这个关系，就没法得到好的结果了。（比如疾病和药物之间的例子，做手术前老是会吃一个药，这样其实会产生它们不独立的信息，但客观上是独立的。）因此，我们也要引入，force一些关系的成立。这应该是可以进行deep research的点吧。
