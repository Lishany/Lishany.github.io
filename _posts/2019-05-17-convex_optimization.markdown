---
layout: post
title:  "优化（一）"
date:   2019-05-17 21:00:00 +0800
categories: optimization
---

## 凸优化问题

定义：凸优化问题研究的是在凸集中找到凸函数的最小值。在凸优化问题中，我们在凸集上找到的最值是全局最优的。\\
此处将涉及牛顿法，割线法，定点法，梯度下降法，共轭梯度下降法等。


## 无约束条件的凸优化问题
这里我们假设优化目标为 $\min_{x} f(x)$，其中$f$为凸函数。一般来说，光从$f(x)$式子，我们很难去直接看出其最值，因此我们必须借助它的一些性质如可微，有显式一次阶方程等去解决该优化问题。

### 求最值解化为求方程解
由于我们的优化目标是最小化凸函数$f$，如果$f$可微，那么这个问题就相当于求解$f'(x)=0$。如果我们能显式地写出方程$f'(x)=0$，那么我们只需要解该方程就行。如果方程是非线性的，我们往往难以获得它的解，只能尽量获得它的近似解，如看似简单的方程$sin(x)=1$。\\
求方程近似解的方法有：二分法（一维情形）、牛顿法、割线法、固定点法，拟牛顿法等。

#### 牛顿法
该方法叫Newton-Raphson method。这是由Newton和Raphson早先在该问题作出的贡献而得名的。\\
在一维情形，牛顿法的迭代公式为$x^{(t+1)}=x^{(t)}-\frac{f'(x^{(t)})}{f'' (x^{(t)})}$。从迭代公式，我们可以看出，基于$x^{(t)}$得到的$x^{(t+1)}$实际上是$f'(x)$过$(x^{(t)},f'(x^{(t)})$点切线在$x$轴上的交点。因而，牛顿法也叫牛顿切线法。在多维情形，迭代公式为$x^{(t+1)}=x^{(t)}-f'' (x^{(t)})^{-1}f'(x^{(t)})$。（下面只对一维情形进行证明，多维情形为类似结果。）\\
设$f'(x^{\*})=0$，将$f'(x^{\*})$在$x^{(t)}$进行Taylor展开(设$f'$已满足展开条件)，可得到$0=f'(x^{\*}) \approx f'(x^{(t)})+(x^{\*}-x^{(t)})f'' (x^{(t)})$，从而得到一维情形的牛顿法迭代公式。\\
一、牛顿法的收敛：将$f'(x^{\*})$在$x^{(t)}$进行Taylor展开，得到$0=f'(x^{\*})=f'(x^{(t)})+(x^{\*}-x^{(t)})f''(x^{(t)})+\frac{1}{2}(x^{\*}-x^{(t)})^2f'''(h)$，$h \in (x^{\*}, x^{(t)})$。从而得到$x^{\*} - x^{(t+1)} = (x^{\*}-x^{(t)})^2 \frac{f''' (h)}{2f'' (x^{(t)}))}$。在$x^{\*}$的领域$U(\delta)=(x^{\*}-\delta,x^{\*}+\delta)$上，令$c(\delta) = \max_{h,x^{(t)} \in U(\delta)} \|\frac{f''' (h)}{2f'' (x^{(t)})}\|$（此处要求$f'' (x^\*) \neq 0$，这样$c(\delta)$才受控制），则有$\|x^{\*} - x^{(t+1)}\| = \|(x^{\*}-x^{(t)})^2 \frac{f''' (h)}{2f'' (x^{(t)}))}\| \leq \|(x^{\*}-x^{(t)})^2\|c(\delta)$，进而$\|x^{\*} - x^{(t+1)}\|c(\delta) \leq \|(x^{\*}-x^{(t)})^2\|c(\delta)^2$，最后$\|x^{\*} - x^{(t)}\| \leq \frac{(\|x^{\*} - x^{(0)}\|c(\delta))^{2^t}}{c(\delta)}$。因此，如果初值选的没那么差的话，上式右边是趋于0的，也就是牛顿法收敛。并且，牛顿法的收敛是二阶的，是很快的收敛速度。\\
二、几个牛顿法收敛的充分条件：\\
1）$f'$二阶可微，且存在$x^{\*}$令$f'(x^{\*})=0$且$f'' (x^{\*})\neq 0$，那么存在$x^{\*}$的领域，使得所有初值在该领域内，牛顿法收敛。（也就是当初值能充分接近精确值时，且满足一定条件，牛顿法是能保证收敛的。）\\
2）$f'$在$[a,b]$上二阶可微，且满足i)$f'(a)f'(b) < 0$, ii)$f'' (x)\neq 0$, iii)$f'' (x)$不变号, v)\|$f'(a)/f'' (a)\|< b-a$,\|$f'(b)/f'' (b)\|< b-a$，牛顿法单调地收敛，且有唯一解。（由于精确值是未知的，所以往往第一个充分条件是难以使用来确保牛顿法的收敛的。这里的充分条件具体化了初值的选取，但也增加了四个保证收敛的条件，其中第一个是表示有存在根，第二个表示根是唯一的，第三个表示该函数凹向是固定的，且第三个第四个保证了迭代值时落在$[a,b]$区间内的。）\\
3)$f'$二阶可微，且为凸函数且有根，那么在任何初值牛顿法都收敛。（这个很明显。）\\
三、牛顿法收敛失败的原因：初值选得差，没有满足收敛条件中对初值的要求，收敛失败的结果可能是形成对冲，震荡，陷入远离根或者死循环的情况。死循环情况是有可能由于初值的选择刚好使得$x^{(t+1)}$获得的$x^{(t+2)}$为$x^{(t)}$，这能通过多次选择不同初值来避免。\\
四、重根情况：$f'' (x^{\*})=0$：在重根情形，牛顿法只是线性收敛。此时，令$f'(x)=(x-x^{\*})^mg'(x)$进行证明即可。\\
五、牛顿法的局限：虽然牛顿法是一个收敛很快的解方程算法，但它在实际是很难应用的。主要的问题在于牛顿法涉及方程二阶导数及其逆的运算，这是相当高的要求。

#### 割线法



